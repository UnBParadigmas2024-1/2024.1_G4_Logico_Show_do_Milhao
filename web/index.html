<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Show do Milhão</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }

        .question {
            font-size: 24px;
            margin-bottom: 20px;
        }

        .options {
            list-style-type: none;
            padding: 0;
        }

        .options li {
            margin: 10px 0;
            cursor: pointer;
        }

        button {
            padding: 10px 20px;
            font-size: 18px;
        }

        #help-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            padding: 5px 10px;
            font-size: 14px;
        }
    </style>
</head>

<body>
    <h1>Show do Milhão</h1>
    <div id="status">Clique no botão para iniciar o jogo</div>
    <button id="start-button" onclick="startGame()">Iniciar Jogo</button>
    <div class="question" id="question" style="display:none;"></div>
    <ul class="options" id="options" style="display:none;"></ul>
    <button id="next-button" onclick="getQuestion()" style="display:none;">Próxima Pergunta</button>
    <button id="help-button" onclick="getHelp()">Ajuda</button>
    <button id="hint-button" onclick="getHint()" style="display:none;">Dica</button>
    <button id="desistir-button" onclick="desistir()" style="display:none;">Desistir</button>
    <div id="valor-acumulado" style="display:none;">Valor Acumulado: R$ 0,00</div>

    <script>
        let valorAcumulado = 0;
        let currentQuestionNumber = 0;

        function startGame() {
            fetch('/api/iniciar')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('status').textContent = data.status;
                    document.getElementById('start-button').style.display = 'none';
                    getQuestion();
                    document.getElementById('desistir-button').style.display = 'block';
                    document.getElementById('valor-acumulado').style.display = 'block';
                })
                .catch(error => console.error('Erro:', error));
        }

        function getQuestion() {
            fetch('/api/pergunta')
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'Fim de jogo') {
                        document.getElementById('status').textContent = 'Fim de jogo! Pontuação: ' + data.pontuacao + ' | Valor Acumulado: R$ ' + data.valor_acumulado;
                        document.getElementById('question').style.display = 'none';
                        document.getElementById('options').style.display = 'none';
                        document.getElementById('next-button').style.display = 'none';
                        document.getElementById('desistir-button').style.display = 'none';
                    } else {
                        if (data.especial) {
                            if (confirm("Você deseja desistir e levar o valor acumulado e um carro?")) {
                                desistir();
                                return;
                            }
                        }
                        currentQuestionNumber = data.numero;
                        document.getElementById('question').textContent = data.pergunta;
                        document.getElementById('question').style.display = 'block';
                        const optionsList = document.getElementById('options');
                        optionsList.innerHTML = '';
                        data.alternativas.forEach((option, index) => {
                            const li = document.createElement('li');
                            li.textContent = option;
                            li.onclick = () => sendAnswer(data.numero, option.charAt(0));
                            optionsList.appendChild(li);
                        });
                        optionsList.style.display = 'block';
                        document.getElementById('next-button').style.display = 'none';
                        document.getElementById('hint-button').style.display = 'block';
                    }
                })
                .catch(error => console.error('Erro:', error));
        }

        function sendAnswer(numero, resposta) {
            fetch('/api/resposta', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ numero: numero, resposta: resposta })
            })
                .then(response => response.json())
                .then(data => {
                    document.getElementById('status').textContent = data.status;
                    if (data.status === 'Correto') {
                        valorAcumulado += 65000;
                        document.getElementById('valor-acumulado').textContent = 'Valor Acumulado: R$ ' + valorAcumulado.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                        document.getElementById('next-button').style.display = 'block';
                        document.getElementById('hint-button').style.display = 'none';
                    } else {
                        document.getElementById('status').textContent += ' A resposta correta é ' + data.resposta_correta;
                        alert("FIM DE JOGO,você vai voltar para casa de bolsos vazios! Resposta errada! A resposta correta é: " + data.resposta_correta);
                        location.reload();
                    }
                })
                .catch(error => console.error('Erro:', error));
        }

        function getHint() {
            fetch('/api/dica', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ numero: currentQuestionNumber })
            })
                .then(response => response.json())
                .then(data => {
                    alert(data.dica);
                })
                .catch(error => console.error('Erro:', error));
        }

        function getHelp() {
            fetch('/api/ajuda')
                .then(response => response.json())
                .then(data => {
                    alert(data.mensagem);
                })
                .catch(error => console.error('Erro:', error));
        }

        function desistir() {
            fetch('/api/desistir')
                .then(response => response.json())
                .then(data => {
                    alert("Você desistiu do jogo! Valor recebido: R$ " + data.valor.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + " e um carro!");
                    location.reload();
                })
                .catch(error => console.error('Erro:', error));
        }
    </script>
</body>

</html>